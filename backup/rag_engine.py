"""
rag_engine.py
ูุญุฑู RAG (Retrieval-Augmented Generation) ููุฅุฌุงุจุฉ ุนูู ุฃุณุฆูุฉ ุงูุนููุงุก
ุญูู ุดุฑูุฉ ุงูุดูุณ ุชูููููู ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงููุญููุธุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุชุฌูุฉ.
"""

import logging
from typing import Optional
from langchain_community.embeddings import HuggingFaceEmbeddings
from langchain_community.vectorstores import Chroma
from langchain_community.chat_models import ChatOllama
from langchain_core.prompts import ChatPromptTemplate
from langchain_core.runnables import RunnablePassthrough
from langchain_core.output_parsers import StrOutputParser

# ุฅุนุฏุงุฏ ุงูุณุฌูุงุช
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# === ุชููุฆุฉ ุงููุธุงู (ูููููุฐ ูุฑุฉ ูุงุญุฏุฉ ุนูุฏ ุงูุงุณุชูุฑุงุฏ) ===
try:
    logger.info("ุฌุงุฑู ุชุญููู ูููุฐุฌ ุงูุชุถููู...")
    embeddings = HuggingFaceEmbeddings(model_name="all-MiniLM-L6-v2")
    
    logger.info("ุฌุงุฑู ุชุญููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุชุฌูุฉ...")
    vectorstore = Chroma(
        persist_directory="./chroma_db", 
        embedding_function=embeddings
    )
    
    # ุฅูุดุงุก Retriever ูุญุณูู ูุงุณุชุฑุฌุงุน ูุนูููุงุช ุฃูุซุฑ ุฏูุฉ
    # ุงุณุชุฎุฏุงู similarity search ูุน ุฒูุงุฏุฉ k ูุงุณุชุฑุฌุงุน ุงููุฒูุฏ ูู ุงููุณุชูุฏุงุช
    retriever = vectorstore.as_retriever(
        search_type="similarity",
        search_kwargs={"k": 10}  # ุฒูุงุฏุฉ k ุฅูู 10 ูุงุณุชุฑุฌุงุน ุงููุฒูุฏ ูู ุงููุนูููุงุช
    )
    
    logger.info("ุฌุงุฑู ุชููุฆุฉ ุงููููุฐุฌ ุงููุบูู...")
    llm = ChatOllama(model="mistral", temperature=0.1)
    
    logger.info("โ ุชู ุชููุฆุฉ ุงููุธุงู ุจูุฌุงุญ")
    
except Exception as e:
    logger.error(f"โ ุฎุทุฃ ูู ุชููุฆุฉ ุงููุธุงู: {str(e)}")
    raise

# ูุงูุจ ุงูุชุนูููุงุช ุงููุญุณูู ูุงูุฏููู ูุน ุดุฎุตูุฉ ุงุญุชุฑุงููุฉ
prompt = ChatPromptTemplate.from_messages([
    ("system", """ุฃูุช ูุณุงุนุฏ ุฐูู ููุฏูุฏ ูุดุฑูุฉ ุงูุดูุณ ุชูููููู ููุฅูุชุฑูุช ูุงูููุจู ุงูุถูุฆู. ุฃูุช ูุชุฎุตุต ูู ูุณุงุนุฏุฉ ุงูุนููุงุก ุจูู ูุฏ ูุงุญุชุฑุงููุฉ.

**ุดุฎุตูุชู:**
- ูุฏูุฏ ูููุฐุจ: ุงุณุชุฎุฏู ูุจุฑุฉ ูุฏูุฉ ูุงุญุชุฑุงููุฉ
- ูููุฏ ููุชุนุงูู: ุงูุฏู ุฏุงุฆูุงู ููุณุงุนุฏุฉ ุงูุนููู
- ุฏููู ููุงุถุญ: ูุฏู ูุนูููุงุช ุฏูููุฉ ูููุธูุฉ
- ุฅูุฌุงุจู: ูู ูุชูุงุฆูุงู ููุดุฌุนุงู

**ุฃุณููุจ ุงูุฅุฌุงุจุฉ:**
1. ุงุจุฏุฃ ุจุชุญูุฉ ูุฏูุฉ ุนูุฏ ุงูุฅุฌุงุจุฉ ุนูู ุงูุณุคุงู ุงูุฃูู
2. ูุธู ุงููุนูููุงุช ุจุดูู ูุงุถุญ ูููุธู (ุงุณุชุฎุฏู ููุงุท ุฅุฐุง ูุงู ููุงู ุฃูุซุฑ ูู ุจุงูุฉ/ุฎุฏูุฉ)
3. ุฃุถู ุชูุงุตูู ูููุฏุฉ ุนูุฏูุง ุชููู ูุชููุฑุฉ (ูุซู: "ูุซุงููุฉ ูู..." ุฃู "ููุงุณุจุฉ ูู...")
4. ุงุฎุชุชู ุจุฅุถุงูุฉ ูููุฏุฉ ูุซู "ูู ุชุญุชุงุฌ ููุฒูุฏ ูู ุงููุนูููุงุชุ" ุฃู "ูุญู ููุง ููุณุงุนุฏุชู!"

**ุชุนูููุงุช ูููุฉ:**
1. **ุงุจุญุซ ุจุนูุงูุฉ ูู ุงููุนูููุงุช ุงูููุฏูุฉ** - ุงููุนูููุงุช ููุฌูุฏุฉุ ููุท ุงุจุญุซ ุฌูุฏุงู.
2. ุฅุฐุง ูุงู ุงูุณุคุงู ุนู "ุฃุณุนุงุฑ" ุฃู "ุจุงูุงุช" ุฃู "ุงุดุชุฑุงูุงุช"ุ ุงุจุญุซ ูู ุงููุนูููุงุช ุนู ุฃู ุฐูุฑ ููุฃุณุนุงุฑุ ุงูุจุงูุงุชุ ุฃู ุงูุงุดุชุฑุงูุงุช.
3. ุฅุฐุง ูุฌุฏุช ุฃู ูุนูููุงุช ุฐุงุช ุตูุฉุ ุฃุฌุจ ุจูุงุกู ุนูููุง ุจุทุฑููุฉ ุดุงููุฉ.
4. ูุง ุชูู "ูุง ุฃููู ูุนูููุงุช ูุงููุฉ" ุฅูุง ุฅุฐุง ุจุญุซุช ุจุนูุงูุฉ ููู ุชุฌุฏ ุฃู ุดูุก ุฐู ุตูุฉ ุนูู ุงูุฅุทูุงู.
5. ุฅุฐุง ูุงู ุงูุณุคุงู ูุตูุฑุงู ูุซู "ุฃุณุนุงุฑ" ุฃู "ุจุงูุงุช"ุ ุงูุชุฑุถ ุฃู ุงููุณุชุฎุฏู ูุณุฃู ุนู ุฃุณุนุงุฑ ูุจุงูุงุช ุงูุฅูุชุฑูุช.
6. ุงุณุชุฎุฑุฌ ูุงุฐูุฑ **ุฌููุน** ุงูุจุงูุงุช ูุงูุฃุณุนุงุฑ ุงูููุฌูุฏุฉ ูู ุงููุนูููุงุช.
7. ุนูุฏ ุฐูุฑ ุงูุฃุณุนุงุฑุ ูุธููุง ุจุดูู ูุงุถุญ: ุงุณู ุงูุจุงูุฉ โ ุงูุณุนุฑ โ ุงููุตู/ุงูููุงุฆุฏ
8. ูุง ุชุฎุชูู ุฃุฑูุงู ุฃู ูุนูููุงุชุ ุงุณุชุฎุฏู ููุท ูุง ููุฌูุฏ ูู ุงููุนูููุงุช ุฃุฏูุงู.

**ุชูุณูู ุงูุฅุฌุงุจุงุช:**
- ููุจุงูุงุช ูุงูุฃุณุนุงุฑ: ุงุณุชุฎุฏู ููุงุฆู ููุธูุฉ
- ููุฎุฏูุงุช: ุงุดุฑุญ ุจุดูู ูุงุถุญ ููููุฏ
- ููุฃุณุฆูุฉ ุงูุนุงูุฉ: ูุฏู ูุธุฑุฉ ุดุงููุฉ ููููุฏุฉ

**ุฃููุงุน ุงูุจุงูุงุช:**
- ุจุงูุงุช ุงููุงุจู ุงูุถูุฆู (FTTH): ูุงูุจุฑ 35ุ ูุงูุจุฑ 50ุ ูุงูุจุฑ 75ุ ูุงูุจุฑ 150
- ุจุงูุงุช ุงููุงูุฑูุณ (WiFi): Starุ Sunุ Neptuneุ Galaxy Star
- ุจุงูุงุช ุงูููุตุฉ"""),
    ("human", """ุงููุนูููุงุช ุงููุชููุฑุฉ ุนู ุดุฑูุฉ ุงูุดูุณ ุชูููููู:
{context}

**ุณุคุงู ุงูุนููู:** {input}

**ููู:** ุงุจุญุซ ูู ุงููุนูููุงุช ุฃุนูุงู ุจุนูุงูุฉ ุนู ุฃู ูุนูููุงุช ุฐุงุช ุตูุฉ ุจุงูุณุคุงู. ูุฏู ุฅุฌุงุจุฉ ุดุงููุฉุ ููุธูุฉุ ููุฏูุฉ. ูุธู ุงููุนูููุงุช ุจุดูู ูุงุถุญ. ุฅุฐุง ูู ุชุฌุฏ ูุนูููุงุช ุนูู ุงูุฅุทูุงูุ ูู ุฐูู ุจุฃุฏุจ.

**ุฃุฌุจ ุจุทุฑููุฉ ุงุญุชุฑุงููุฉุ ูุฏูุฉุ ููููุฏุฉ:**""")
])


def format_docs(docs) -> str:
    """ุชูุณูู ุงููุณุชูุฏุงุช ุงููุณุชุฑุฌุนุฉ ูู ูุต ูุงุญุฏ"""
    if not docs:
        return "ูุง ุชูุฌุฏ ูุนูููุงุช ูุงููุฉ."
    
    # ุชูุณูู ุงููุณุชูุฏุงุช ูุน ุฅุถุงูุฉ ููุงุตู ูุงุถุญุฉ
    formatted = []
    for i, doc in enumerate(docs, 1):
        formatted.append(f"[ุงููุตุฏุฑ {i}]\n{doc.page_content}")
    
    return "\n\n---\n\n".join(formatted)


# ุณูุณูุฉ RAG ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู
rag_chain = (
    {"context": retriever | format_docs, "input": RunnablePassthrough()}
    | prompt
    | llm
    | StrOutputParser()
)


def expand_query(question: str) -> str:
    """
    ุชูุณูุน ุงูุงุณุชุนูุงู ุจุฅุถุงูุฉ ูุฑุงุฏูุงุช ููููุงุช ููุชุงุญูุฉ ูุชุญุณูู ุงูุจุญุซ
    
    Args:
        question: ุงูุณุคุงู ุงูุฃุตูู
        
    Returns:
        ุงูุณุคุงู ุงูููุณูุน
    """
    question_lower = question.lower()
    expanded = question
    
    # ูููุงุช ููุชุงุญูุฉ ููุจุญุซ ุนู ุงูุจุงูุงุช ูุงูุฃุณุนุงุฑ
    price_keywords = ["ุณุนุฑ", "ุฃุณุนุงุฑ", "ุชูููุฉ", "ุซูู", "ุงูุณุนุฑ", "ุงูุฃุณุนุงุฑ", "ุงูุชูููุฉ", "ุงูุซูู"]
    package_keywords = ["ุจุงูุฉ", "ุจุงูุงุช", "ุงุดุชุฑุงู", "ุงุดุชุฑุงูุงุช", "ุงูุงุดุชุฑุงู", "ุงูุงุดุชุฑุงูุงุช", "ุงูุจุงูุฉ", "ุงูุจุงูุงุช"]
    internet_keywords = ["ุฅูุชุฑูุช", "ุงูุฅูุชุฑูุช", "ุงูุชุฑูุช", "ุฃูุชุฑูุช"]
    
    # ุงูุชุญูู ูู ูุญุชูู ุงูุณุคุงู
    has_price_query = any(word in question_lower for word in price_keywords)
    has_package_query = any(word in question_lower for word in package_keywords)
    has_internet_query = any(word in question_lower for word in internet_keywords)
    
    # ุฅุฐุง ูุงู ุงูุณุคุงู ุนู ุงูุจุงูุงุช ุฃู ุงูุฃุณุนุงุฑุ ุฃุถู ูููุงุช ููุชุงุญูุฉ
    if has_package_query or has_price_query:
        # ุฅุถุงูุฉ ูููุงุช ููุชุงุญูุฉ ูููุฉ
        keywords_to_add = []
        
        if not has_internet_query:
            keywords_to_add.append("ุงูุฅูุชุฑูุช")
        
        if has_package_query and not has_price_query:
            keywords_to_add.extend(["ุฃุณุนุงุฑ", "ุงูุณุนุฑ", "ุฏููุงุฑ"])
        
        if has_price_query and not has_package_query:
            keywords_to_add.extend(["ุจุงูุงุช", "ุงุดุชุฑุงูุงุช", "FTTH", "WiFi"])
        
        # ุฅุถุงูุฉ ูููุงุช ููุชุงุญูุฉ ุฅุถุงููุฉ ููุจุงูุงุช
        if has_package_query:
            keywords_to_add.extend(["ูุงูุจุฑ", "FTTH", "ูุงูุฑูุณ", "WiFi"])
        
        if keywords_to_add:
            expanded = f"{question} {' '.join(keywords_to_add)}"
    
    # ุฅุฐุง ูุงู ุงูุณุคุงู ุนุงูุงู ุนู "ุงุดุชุฑุงูุงุช" ุฃู "ุจุงูุงุช" ุจุฏูู ุชูุงุตูู
    if any(word in question_lower for word in ["ุงุดุชุฑุงูุงุช", "ุจุงูุงุช", "ุงูุงุดุชุฑุงูุงุช", "ุงูุจุงูุงุช", "ุงุดุชุฑุงู", "ุจุงูุฉ"]):
        # ุฏุงุฆูุงู ุฃุถู ูููุงุช ููุชุงุญูุฉ ููุจุญุซ ุนู ุงูุจุงูุงุช ูุงูุฃุณุนุงุฑ
        expanded_keywords = ["ุฃุณุนุงุฑ", "ุจุงูุงุช", "ุงูุฅูุชุฑูุช", "ุงููุงุจู", "ุงูุถูุฆู", "FTTH", "WiFi", "ูุงูุฑูุณ", "ูุงูุจุฑ", "ุฏููุงุฑ"]
        expanded = f"{question} {' '.join(expanded_keywords)}"
    
    return expanded


def enhance_response(response: str, question: str) -> str:
    """
    ุชุญุณูู ุงูุฅุฌุงุจุฉ ูุฌุนููุง ุฃูุซุฑ ูุฏูุฉ ูุงุญุชุฑุงููุฉ
    
    Args:
        response: ุงูุฅุฌุงุจุฉ ุงูุฎุงู ูู LLM
        question: ุงูุณุคุงู ุงูุฃุตูู
        
    Returns:
        ุงูุฅุฌุงุจุฉ ุงููุญุณููุฉ
    """
    if not response or len(response.strip()) < 5:
        return response
    
    response_clean = response.strip()
    question_lower = question.lower().strip()
    
    # ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ุณูุจูุฉ (ูุง ูุนูููุงุช)ุ ุงุฌุนููุง ุฃูุซุฑ ูุฏูุฉ
    if any(phrase in response_clean for phrase in ["ูุง ุฃููู", "ูุง ูุนูููุงุช", "ุบูุฑ ูุชููุฑุฉ"]):
        enhanced = f"ุนุฐุฑูุงุ ูู ุฃุฌุฏ ูุนูููุงุช ูุญุฏุฏุฉ ุญูู '{question}' ูู ูุงุนุฏุฉ ุจูุงูุงุชูุง.\n\n"
        enhanced += "ููู ูููููู ูุณุงุนุฏุชู ูู:\n"
        enhanced += "โข ูุนุฑูุฉ ูุนูููุงุช ุนู ุฎุฏูุงุชูุง ูุจุงูุงุชูุง\n"
        enhanced += "โข ุงูุชุนุฑู ุนูู ุดุฑุงูุงุชูุง\n"
        enhanced += "โข ูุนูููุงุช ุงูุชูุงุตู ูุนูุง\n\n"
        enhanced += "ูู ุชุฑูุฏ ุฃู ุฃุณุงุนุฏู ูู ุฃู ูู ูุฐู ุงูููุงุถูุนุ ๐"
        return enhanced
    
    # ุฅุถุงูุฉ ุชุญุณููุงุช ููุฅุฌุงุจุงุช ุงูุฅูุฌุงุจูุฉ
    # ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ ุนู ุงูุจุงูุงุช/ุงูุฃุณุนุงุฑุ ุฃุถู ุฏุนูุฉ ููุชูุงุตู
    if any(word in question_lower for word in ["ุจุงูุฉ", "ุจุงูุงุช", "ุณุนุฑ", "ุฃุณุนุงุฑ", "ุงุดุชุฑุงู"]):
        if "ุ" not in response_clean[-2:] and "." not in response_clean[-2:]:
            response_clean += "."
        
        # ุฅุถุงูุฉ ุฏุนูุฉ ููุชูุงุตู ูู ุงูููุงูุฉ
        if "ููุชูุงุตู" not in response_clean.lower() and "ุงุชุตู" not in response_clean.lower():
            response_clean += "\n\n๐ก ูุตูุญุฉ: ููุญุตูู ุนูู ูุฒูุฏ ูู ุงูุชูุงุตูู ุฃู ุงูุงุดุชุฑุงูุ ููููู ุงูุชูุงุตู ูุนูุง ุนูู ุงูุฑูู 6449 ุฃู ุนุจุฑ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู info@shams-tele.com"
    
    return response_clean


def get_answer(question: str) -> str:
    """
    ุงูุญุตูู ุนูู ุฅุฌุงุจุฉ ูู ุงูุจูุช ุจูุงุกู ุนูู ุงูุณุคุงู
    
    Args:
        question: ุงูุณุคุงู ุงูุฐู ูุฑูุฏ ุงููุณุชุฎุฏู ุฅุฌุงุจุชู
        
    Returns:
        ุฅุฌุงุจุฉ ุงูุจูุช ูุณูุณูุฉ ูุตูุฉ ูุญุณููุฉ
        
    Raises:
        Exception: ูู ุญุงูุฉ ุญุฏูุซ ุฎุทุฃ ุฃุซูุงุก ุงููุนุงูุฌุฉ
    """
    try:
        if not question or not question.strip():
            return "ูุฑุญุจุงู! ๐ ููู ูููููู ูุณุงุนุฏุชู ุงููููุ ููููู ุณุคุงูู ุนู ุฎุฏูุงุชูุงุ ุจุงูุงุชูุงุ ุฃู ุฃู ูุนูููุงุช ุนู ุดุฑูุฉ ุงูุดูุณ ุชูููููู."
        
        clean_question = question.strip()
        
        # ุชุณุฌูู ุงูุณุคุงู ูููุณุงุนุฏุฉ ูู ุงูุชุตุญูุญ
        logger.info(f"ูุนุงูุฌุฉ ุงูุณุคุงู: {clean_question}")
        
        # ุชูุณูุน ุงูุงุณุชุนูุงู ูุชุญุณูู ุงูุจุญุซ
        expanded_query = expand_query(clean_question)
        if expanded_query != clean_question:
            logger.info(f"ุงูุณุคุงู ุงูููุณูุน: {expanded_query}")
        
        # ุงุณุชุฑุฌุงุน ุงููุณุชูุฏุงุช ุจุงุณุชุฎุฏุงู ุงูุณุคุงู ุงูููุณูุน
        retrieved_docs = retriever.invoke(expanded_query)
        
        # ุฅุฐุง ูู ูุชู ุงูุนุซูุฑ ุนูู ูุณุชูุฏุงุชุ ุญุงูู ุงุณุชุฑุงุชูุฌูุงุช ุจุฏููุฉ
        if not retrieved_docs:
            logger.warning(f"โ ูู ูุชู ุงูุนุซูุฑ ุนูู ูุณุชูุฏุงุช ููุณุคุงู ุงูููุณูุน: {expanded_query}")
            # ูุญุงููุฉ 1: ุงูุจุญุซ ุจุงูุณุคุงู ุงูุฃุตูู
            retrieved_docs = retriever.invoke(clean_question)
            if not retrieved_docs:
                # ูุญุงููุฉ 2: ุงูุจุญุซ ุจูููุงุช ููุชุงุญูุฉ ุจุณูุทุฉ
                simple_query = clean_question.replace("ูุง ูู", "").replace("ุ", "").strip()
                retrieved_docs = retriever.invoke(simple_query)
                if not retrieved_docs:
                    # ูุญุงููุฉ 3: ุงูุจุญุซ ุจูููุงุช ููุชุงุญูุฉ ุฑุฆูุณูุฉ ููุท
                    keywords = []
                    if any(word in clean_question.lower() for word in ["ุจุงูุฉ", "ุจุงูุงุช", "ุงุดุชุฑุงู", "ุงุดุชุฑุงูุงุช"]):
                        keywords.extend(["ุจุงูุงุช", "ุงุดุชุฑุงูุงุช", "ุฃุณุนุงุฑ"])
                    if any(word in clean_question.lower() for word in ["ุณุนุฑ", "ุฃุณุนุงุฑ", "ุงูุณุนุฑ"]):
                        keywords.extend(["ุฃุณุนุงุฑ", "ุงูุณุนุฑ", "ุฏููุงุฑ"])
                    if keywords:
                        final_query = " ".join(keywords)
                        logger.info(f"๐ ูุญุงููุฉ ุงูุจุญุซ ุจูููุงุช ููุชุงุญูุฉ: {final_query}")
                        retrieved_docs = retriever.invoke(final_query)
            
            if not retrieved_docs:
                logger.error(f"โ ูุดู ูู ุงูุนุซูุฑ ุนูู ุฃู ูุณุชูุฏุงุช ููุณุคุงู: {clean_question}")
                # ุฅุฌุงุจุฉ ูุฏูุฉ ุญุชู ุนูุฏ ุนุฏู ูุฌูุฏ ูุนูููุงุช
                return enhance_response("ุนุฐุฑูุงุ ูุง ุฃููู ูุนูููุงุช ูุงููุฉ ุญูู ูุฐุง ุงูููุถูุน.", clean_question)
        
        logger.info(f"โ ุชู ุงุณุชุฑุฌุงุน {len(retrieved_docs)} ูุณุชูุฏ(ุงุช) ููุณุคุงู")
        
        # ุทุจุงุนุฉ ุฃูู ุฌุฒุก ูู ุงููุณุชูุฏุงุช ุงููุณุชุฑุฌุนุฉ ูููุณุงุนุฏุฉ ูู ุงูุชุตุญูุญ
        if retrieved_docs:
            for i, doc in enumerate(retrieved_docs[:2], 1):
                preview = doc.page_content[:150].replace('\n', ' ').strip()
                logger.debug(f"   ๐ ุงููุณุชูุฏ {i}: {preview}...")
        
        # ุฅุฑุณุงู ุงูุณุคุงู ุงูุฃุตูู ูุงููุณุชูุฏุงุช ุงููุณุชุฑุฌุนุฉ ุฅูู RAG chain
        response = rag_chain.invoke(clean_question)
        
        logger.info(f"ุชู ุงูุญุตูู ุนูู ุฅุฌุงุจุฉ ููุณุคุงู: {clean_question[:50]}...")
        
        # ุชุญุณูู ุงูุฅุฌุงุจุฉ
        enhanced_response = enhance_response(response, clean_question)
        
        return enhanced_response.strip()
        
    except Exception as e:
        logger.error(f"ุฎุทุฃ ุฃุซูุงุก ูุนุงูุฌุฉ ุงูุณุคุงู '{question}': {str(e)}")
        logger.exception(e)
        return "ุนุฐุฑูุงุ ุญุฏุซ ุฎุทุฃ ุบูุฑ ูุชููุน ุฃุซูุงุก ูุนุงูุฌุฉ ุณุคุงูู. ูุฑุฌู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู ุฃู ุงูุชูุงุตู ูุนูุง ูุจุงุดุฑุฉ ุนูู 6449. ๐"